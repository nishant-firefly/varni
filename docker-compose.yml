version: '3'
services:
  localstack:
    image: localstack/localstack
    ports:
      - "4570-4580:4566"
      - "4590:4590"  # Web UI port
    environment:
      - DOCKER_HOST=unix:///var/run/docker.sock
    volumes:
      - "./localstack:/etc/localstack"
    extra_hosts:
      - "host.docker.internal:host-gateway"

  fastapi:
    build: .
    ports:
      - "8000:8000"  # Map port 8000 on the host to port 8000 in the container
    volumes:
      - .:/app
    command: uvicorn main:app --host 0.0.0.0 --port 8000
